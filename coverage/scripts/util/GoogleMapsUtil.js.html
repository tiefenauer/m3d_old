<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for scripts/util/GoogleMapsUtil.js</title>
    <meta charset="utf-8">

    <link rel="stylesheet" href="../../prettify.css">

    <link rel="stylesheet" href="../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header low">
    <h1>Code coverage report for <span class="entity">scripts/util/GoogleMapsUtil.js</span></h1>
    <h2>
        
        Statements: <span class="metric">18% <small>(9 / 50)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">11.11% <small>(1 / 9)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">18.37% <small>(9 / 49)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../index.html">All files</a> &#187; <a href="index.html">scripts/util/</a> &#187; GoogleMapsUtil.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/*jshint bitwise: false*/
'use strict';
/**
* info.tiefenauer.maps3d.util.GoogleMapsUtil
* Utility class with various static functions regarding GoogleMaps functionality.
* (c) 2014 Daniel Tiefenauer
* @author: Daniel Tiefenauer
*/
define([], function(){
	/**
	* Encode an array of coordinates for URL Request
	* @param coords the coordinates to be encoded
	*/
	var createEncodings = <span class="fstat-no" title="function not covered" >function (coords) {</span>
<span class="cstat-no" title="statement not covered" >		var i = 0;</span>
	 
<span class="cstat-no" title="statement not covered" >		var plat = 0;</span>
<span class="cstat-no" title="statement not covered" >		var plng = 0;</span>
	 
<span class="cstat-no" title="statement not covered" >		var encodedPoints = '';</span>
	 
<span class="cstat-no" title="statement not covered" >		for(i = 0; i &lt; coords.length; ++i) {</span>
<span class="cstat-no" title="statement not covered" >		    var lat = coords[i][0];				</span>
<span class="cstat-no" title="statement not covered" >			var lng = coords[i][1];		</span>
	 
<span class="cstat-no" title="statement not covered" >			encodedPoints += encodePoint(plat, plng, lat, lng);</span>
	 
<span class="cstat-no" title="statement not covered" >		    plat = lat;</span>
<span class="cstat-no" title="statement not covered" >		    plng = lng;</span>
		}
	 
		// close polyline
		//encoded_points += self.encodePoint(plat, plng, coords[0][0], coords[0][1]);
	 
<span class="cstat-no" title="statement not covered" >		return encodedPoints;</span>
	};
&nbsp;
	/**
	* Encode a single points for URL Request
	* @param the point to be encoded
	*/	 
	var encodePoint = <span class="fstat-no" title="function not covered" >function(plat, plng, lat, lng) {</span>
<span class="cstat-no" title="statement not covered" >		var late5 = Math.round(lat * 1e5);</span>
<span class="cstat-no" title="statement not covered" >	    var plate5 = Math.round(plat * 1e5);    </span>
	 
<span class="cstat-no" title="statement not covered" >		var lnge5 = Math.round(lng * 1e5);</span>
<span class="cstat-no" title="statement not covered" >	    var plnge5 = Math.round(plng * 1e5);</span>
	 
<span class="cstat-no" title="statement not covered" >		var dlng = lnge5 - plnge5;</span>
<span class="cstat-no" title="statement not covered" >		var dlat = late5 - plate5;</span>
	 
<span class="cstat-no" title="statement not covered" >	    return encodeSignedNumber(dlat) + encodeSignedNumber(dlng);</span>
	};
 
 	/**
 	* encode a signed number
 	* @param num signed numeric value
 	*/
	var encodeSignedNumber = <span class="fstat-no" title="function not covered" >function(num) {</span>
<span class="cstat-no" title="statement not covered" >	  var sgnNum = num &lt;&lt; 1;</span>
	 
<span class="cstat-no" title="statement not covered" >	  if (num &lt; 0) {</span>
<span class="cstat-no" title="statement not covered" >	    sgnNum = ~(sgnNum);</span>
	  }
	 
<span class="cstat-no" title="statement not covered" >	  return(encodeNumber(sgnNum));</span>
	};
	 
	/**
	* Encode an unsigned number
	* @param num unsigned numeric value
	*/
	var encodeNumber = <span class="fstat-no" title="function not covered" >function(num) {</span>
<span class="cstat-no" title="statement not covered" >	  var encodeString = '';</span>
	 
<span class="cstat-no" title="statement not covered" >	  while (num &gt;= 0x20) {</span>
<span class="cstat-no" title="statement not covered" >	    encodeString += (String.fromCharCode((0x20 | (num &amp; 0x1f)) + 63));</span>
<span class="cstat-no" title="statement not covered" >	    num &gt;&gt;= 5;</span>
	  }
	 
<span class="cstat-no" title="statement not covered" >	  encodeString += (String.fromCharCode(num + 63));</span>
<span class="cstat-no" title="statement not covered" >	  return encodeString;</span>
	};
&nbsp;
	/**
	* Calculate distance between two points on earth in meters using the haversine formula.
	* @param p1 first point
	* @param p2 second point
	* @see http://en.wikipedia.org/wiki/Haversine_formula
	*/
	var degreeToMeter = <span class="fstat-no" title="function not covered" >function(p1, p2){</span>
<span class="cstat-no" title="statement not covered" >		Number.prototype.toRad = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return this * Math.PI / 180; </span>};</span>
<span class="cstat-no" title="statement not covered" >		var R = 6371; </span>// Earth radius in km
<span class="cstat-no" title="statement not covered" >		var dLat = Number(Math.max(p1.lat, p2.lat)-Math.min(p1.lat, p2.lat)).toRad();</span>
<span class="cstat-no" title="statement not covered" >		var dLng = Number(Math.max(p1.lng, p2.lng)-Math.min(p1.lng, p2.lng)).toRad();</span>
<span class="cstat-no" title="statement not covered" >		var lat1 = Number(p1.lat).toRad();</span>
<span class="cstat-no" title="statement not covered" >		var lat2 = Number(p2.lat).toRad();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >		var a = Math.sin(dLat/2) * Math.sin(dLat/2) +</span>
		        Math.sin(dLng/2) * Math.sin(dLng/2) * Math.cos(lat1) * Math.cos(lat2); 
<span class="cstat-no" title="statement not covered" >		var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); </span>
<span class="cstat-no" title="statement not covered" >		var d = R * c;</span>
<span class="cstat-no" title="statement not covered" >		return d*1000;</span>
	};
&nbsp;
	/**
	* Convert an angle from radian to degree
	* @param angle value in radian
	*/ 
	var toDegree = <span class="fstat-no" title="function not covered" >function(angle){</span>
<span class="cstat-no" title="statement not covered" >		return angle * (180/Math.PI);</span>
	};
&nbsp;
	/**
	* Convert an angle from degree to radian
	* @param angle value in degree
	*/
	var toRad = <span class="fstat-no" title="function not covered" >function(angle){</span>
<span class="cstat-no" title="statement not covered" >		return angle * (Math.PI/180);</span>
	};		
&nbsp;
	return {
		 createEncodings: createEncodings
		,encodePoint: encodePoint
		,encodeSignedNumber: encodeSignedNumber
		,encodeNumber: encodeNumber
		,degreeToMeter: degreeToMeter
		,toDegree: toDegree
		,toRad: toRad
	};
});
&nbsp;</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Mar 08 2015 13:07:14 GMT+0000 (UTC)</div>
</div>

<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>

<script src="../../sorter.js"></script>
</body>
</html>
